/home/ivanovnp/.cache/pypoetry/virtualenvs/rtu-mirea-lgc4TVed-py3.11/bin/python3.11 /home/ivanovnp/rtu_mirea/big_data/src/pr5_tweets/graphframes/nth_user_msg_chain/q2.py
23/11/29 19:27:55 WARN Utils: Your hostname, ivanovnp-bigdata resolves to a loopback address: 127.0.1.1; using 192.168.71.129 instead (on interface ens33)
23/11/29 19:27:55 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/home/ivanovnp/.cache/pypoetry/virtualenvs/rtu-mirea-lgc4TVed-py3.11/lib/python3.11/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/ivanovnp/.ivy2/cache
The jars for the packages stored in: /home/ivanovnp/.ivy2/jars
graphframes#graphframes added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-820f5de0-0a97-4d69-bc6e-39203e573aa6;1.0
	confs: [default]
	found graphframes#graphframes;0.8.3-spark3.5-s_2.12 in spark-packages
	found org.slf4j#slf4j-api;1.7.16 in central
:: resolution report :: resolve 200ms :: artifacts dl 5ms
	:: modules in use:
	graphframes#graphframes;0.8.3-spark3.5-s_2.12 from spark-packages in [default]
	org.slf4j#slf4j-api;1.7.16 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   2   |   0   |   0   |   0   ||   2   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-820f5de0-0a97-4d69-bc6e-39203e573aa6
	confs: [default]
	0 artifacts copied, 2 already retrieved (0kB/6ms)
23/11/29 19:27:57 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
2023-11-29 19:28:18.895 | INFO     | __main__:<module>:30 - df
+------------------+--------------------+-------------------+------------------+--------------+------------------+-----------+
|           tweetid|              userid|in_reply_to_tweetid|in_reply_to_userid|retweet_userid|   retweet_tweetid|reply_count|
+------------------+--------------------+-------------------+------------------+--------------+------------------+-----------+
|492388766930444288|0974d5dbee4ca9bd6...|               NULL|              NULL|          NULL|              NULL|          0|
|719455077589721089|bda40f262856eee77...| 719439882993545216|          40807205|          NULL|              NULL|          0|
|536179342423105537|bda40f262856eee77...|               NULL|              NULL|          NULL|              NULL|          0|
|841410788409630720|a53ed619f1dea6015...|               NULL|              NULL|          NULL|              NULL|          0|
|834365760776630272|a53ed619f1dea6015...|               NULL|              NULL|          NULL|              NULL|          0|
|577490527299457024|95b3aba6b9140f5dd...|               NULL|              NULL|    2599775719|577485402124111872|          0|
|596522755379560448|5744c546bdf9e81ea...|               NULL|              NULL|    2518710111|596514222684524545|          0|
|567357519547207680|2b0d7525bed1df511...|               NULL|              NULL|          NULL|              NULL|          0|
|665533117369876480|b88fd4fc4b169f0a9...|               NULL|              NULL|      72525490|665522169724739584|          0|
|493894187079974912|be1e8e099e93fe096...|               NULL|              NULL|          NULL|              NULL|          0|
|493688319902220288|be1e8e099e93fe096...|               NULL|              NULL|          NULL|              NULL|          0|
|497543470211678209|be1e8e099e93fe096...|               NULL|              NULL|          NULL|              NULL|          0|
|701008777001107457|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
|725740300065366016|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
|704248884072046592|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
|710845825622999040|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
|648955031081758720|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
|704222907304534016|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
|860151003752132609|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
|918116356117139459|f9dded769bb2275fc...|               NULL|              NULL|          NULL|              NULL|          0|
+------------------+--------------------+-------------------+------------------+--------------+------------------+-----------+
only showing top 20 rows

2023-11-29 19:28:19.399 | INFO     | __main__:<module>:34 - vertices
+--------------------+
|                  id|
+--------------------+
|f04abf2e3b127a364...|
|0606cb1e17a9de133...|
|00b6194ca3359e2f3...|
|0ab37cc5aec441fef...|
|01523cbff35635449...|
+--------------------+
only showing top 5 rows

2023-11-29 19:28:32.341 | INFO     | __main__:<module>:42 - edges_df
+--------------------+---------+------------------+
|                 src|      dst|      relationship|
+--------------------+---------+------------------+
|bda40f262856eee77...| 40807205|719455077589721089|
|c90f90a5d12c3c47b...|957051660|279978567025176576|
|          2882331822|164332083|662532293613875201|
|          2882331822|   742143|607812929568636928|
|f88c1aa7a3a72c572...| 18138592|510115778256203776|
+--------------------+---------+------------------+
only showing top 5 rows

/home/ivanovnp/.cache/pypoetry/virtualenvs/rtu-mirea-lgc4TVed-py3.11/lib/python3.11/site-packages/pyspark/sql/dataframe.py:168: UserWarning: DataFrame.sql_ctx is an internal property, and will be removed in future releases. Use DataFrame.sparkSession instead.
  warnings.warn(
/home/ivanovnp/.cache/pypoetry/virtualenvs/rtu-mirea-lgc4TVed-py3.11/lib/python3.11/site-packages/pyspark/sql/dataframe.py:147: UserWarning: DataFrame constructor is internal. Do not directly use it.
  warnings.warn("DataFrame constructor is internal. Do not directly use it.")
2023-11-29 19:28:32.764 | INFO     | __main__:<module>:48 - motif_pattern: (a)-[]->(b);(b)-[e]->(a)
2023-11-29 19:29:03.479 | INFO     | __main__:<module>:51 - motif_df - count: 44299154
+--------------------+--------------------+--------------------+
|                   a|                   b|                   e|
+--------------------+--------------------+--------------------+
|{0606cb1e17a9de13...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{0606cb1e17a9de13...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{0606cb1e17a9de13...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{8db3fc6a4b17f997...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{8db3fc6a4b17f997...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{8db3fc6a4b17f997...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{8db3fc6a4b17f997...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{8db3fc6a4b17f997...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{8db3fc6a4b17f997...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{b674c51c2ae3b105...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
|{beca91052aeb5f19...|{004c1875a5f3a8dd...|{004c1875a5f3a8dd...|
+--------------------+--------------------+--------------------+
only showing top 20 rows

root
 |-- a: struct (nullable = false)
 |    |-- id: string (nullable = true)
 |-- b: struct (nullable = false)
 |    |-- id: string (nullable = true)
 |-- e: struct (nullable = false)
 |    |-- src: string (nullable = true)
 |    |-- dst: string (nullable = true)
 |    |-- relationship: long (nullable = true)

2023-11-29 19:29:32.773 | INFO     | __main__:<module>:59 - n_th_level_df
+--------------------+-------+
|                  id|  count|
+--------------------+-------+
|4f36e5750305a0f3e...|4531469|
|b059c98801ff33056...|4045720|
|b4dda195d6629b6fe...|3964220|
|57f6f83add72ac7ae...|3260895|
|e0790efc801679b89...|2748057|
|94c54df165195f1fd...|2732701|
|eef41019a744ac16d...|2593889|
|86e0b060b28268a40...|2162763|
|f22e2d20ba79d7129...|1999252|
|992383d1e284b292a...|1711268|
|050f6f287ff564463...|1638524|
|d5935f3675e33adea...|1340184|
|           535791711|1325595|
|d13cf22cd34f57aaf...|1281829|
|           462272724|1145035|
|           471868887|1051986|
|8082409924dba910b...| 986620|
|c4911e95266bfd886...| 984573|
|bee7d3ea2fb7ece34...| 481755|
|eeb98f72837186582...| 341970|
+--------------------+-------+
only showing top 20 rows

2023-11-29 19:30:39.732 | INFO     | __main__:<module>:64 - The user who started the 4-th longest chain is 57f6f83add72ac7ae0953dbffd324e1f0e3ed73cb5dc2a9a394dacb39508bd1f

Process finished with exit code 0
